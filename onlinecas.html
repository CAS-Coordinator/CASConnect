<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Online CAS Explorer (Japan Nov-Dec 2025)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/alpinejs@3.x.x/dist/cdn.min.js" defer></script>
    <!-- Chosen Palette: Warm Neutrals with Soft Blue Accents -->
    <!-- Application Structure Plan: A clean, single-page application. It starts with an introduction (from the report's foreword). The core is the 'Find Activities' section, an interactive tool with filters (Strand, Focus, Cost, Month) and sorting, displaying results as cards with a modal for details. This structure is task-oriented, prioritizing the student's need to find information quickly. -->
    <!-- Visualization & Content Choices: Report Data (Activity List) -> Goal: Exploration & Filtering -> Presentation: Interactive card list (HTML/Tailwind/Alpine.js). Report Data (Activity Details) -> Goal: In-depth Info -> Presentation: Modal popup (JS toggle). No charts are included to maintain focus and avoid potential rendering errors. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body { font-family: 'Inter', sans-serif; }
        .nav-link { transition: color 0.3s ease, border-bottom-color 0.3s ease; }
        .nav-link.active { border-bottom-color: #3B82F6; color: #3B82F6; }
        .modal { display: none; }
        .modal.active { display: flex; }
        .tag { display: inline-block; padding: 0.25rem 0.75rem; font-size: 0.8rem; border-radius: 9999px; margin-right: 0.5rem; margin-bottom: 0.5rem; }
        .tag-creativity { background-color: #ECFCCB; color: #4D7C0F; border: 1px solid #A3E635; }
        .tag-activity { background-color: #CFFAFE; color: #0E7490; border: 1px solid #67E8F9; }
        .tag-service { background-color: #FFE4E6; color: #BE123C; border: 1px solid #FDA4AF; }
        .modal-content::-webkit-scrollbar { width: 8px; }
        .modal-content::-webkit-scrollbar-track { background: #f1f1f1; border-radius: 10px; }
        .modal-content::-webkit-scrollbar-thumb { background: #3B82F6; border-radius: 10px; }
        .modal-content::-webkit-scrollbar-thumb:hover { background: #2563EB; }
        [x-cloak] { display: none !important; }
    </style>
</head>
<body class="bg-stone-100 text-gray-800" x-data="casApp()">
    <header class="bg-white shadow-md sticky top-0 z-50">
        <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex items-center justify-between h-16">
                <div class="flex-shrink-0">
                    <h1 class="text-xl font-bold text-blue-600">Online CAS Explorer</h1>
                    <span class="text-sm text-gray-500">Nov-Dec 2025</span>
                </div>
                <div class="hidden md:block">
                    <div class="ml-10 flex items-baseline space-x-4">
                        <a href="#home" @click="setActiveSection('home')" :class="{ 'active': activeSection === 'home' }" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600">Home</a>
                        <a href="#find-activities" @click="setActiveSection('find-activities')" :class="{ 'active': activeSection === 'find-activities' }" class="nav-link px-3 py-2 rounded-md text-sm font-medium text-gray-700 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600">Find Activities</a>
                    </div>
                </div>
                <div class="md:hidden">
                    <button @click="mobileMenuOpen = !mobileMenuOpen" type="button" class="bg-white inline-flex items-center justify-center p-2 rounded-md text-gray-500 hover:text-blue-600 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-blue-500" aria-controls="mobile-menu" aria-expanded="false">
                        <span class="sr-only">Open main menu</span>
                        <svg class="block h-6 w-6" x-show="!mobileMenuOpen" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                        </svg>
                        <svg class="h-6 w-6" x-show="mobileMenuOpen" x-cloak xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" aria-hidden="true">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
                        </svg>
                    </button>
                </div>
            </div>
        </nav>
        <div x-show="mobileMenuOpen" x-cloak class="md:hidden" id="mobile-menu">
            <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                <a href="#home" @click="setActiveSection('home'); mobileMenuOpen = false;" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50">Home</a>
                <a href="#find-activities" @click="setActiveSection('find-activities'); mobileMenuOpen = false;" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-blue-600 hover:bg-gray-50">Find Activities</a>
            </div>
        </div>
    </header>

    <main class="container mx-auto p-4 sm:p-6 lg:p-8">
        <section id="home" class="py-8 md:py-12 bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-3xl font-bold text-blue-600 mb-4">Welcome to the Online CAS Explorer!</h2>
            <p class="text-lg text-gray-700 mb-3">This tool is designed to help high school students in Japan find online CAS opportunities for <strong class="text-blue-500">November and December 2025</strong>.</p>
            <p class="text-gray-600">Online activities offer incredible flexibility and access to global projects. This explorer provides a starting point for your CAS journey, focusing on activities you can participate in from anywhere. Remember to verify details and discuss your plans with your CAS Coordinator.</p>
        </section>

        <section id="find-activities" class="py-8 md:py-12 bg-white rounded-lg shadow-lg p-6 mb-8">
            <h2 class="text-2xl font-bold text-gray-800 mb-6 text-center">Find Online Activities (Nov-Dec 2025)</h2>
            
            <div class="mb-8 p-4 border border-blue-200 rounded-lg bg-blue-50">
                <p class="text-sm text-blue-700">Use the filters below to find activities. Click on an activity card for more details. All information is based on public data and should be verified with organizers.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6 items-end">
                <div>
                    <label for="filter-strand" class="block text-sm font-medium text-gray-700 mb-1">CAS Strand</label>
                    <select id="filter-strand" x-model="filters.strand" @change="applyFilters" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Strands</option>
                        <option value="Creativity">Creativity</option>
                        <option value="Activity">Activity</option>
                        <option value="Service">Service</option>
                    </select>
                </div>
                <div>
                    <label for="filter-focus" class="block text-sm font-medium text-gray-700 mb-1">Location Focus</label>
                    <select id="filter-focus" x-model="filters.focus" @change="applyFilters" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Focus</option>
                        <option value="Japan Focus">Japan Focus</option>
                        <option value="Global">Global</option>
                    </select>
                </div>
                <div>
                    <label for="filter-cost" class="block text-sm font-medium text-gray-700 mb-1">Cost</label>
                    <select id="filter-cost" x-model="filters.cost" @change="applyFilters" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Costs</option>
                        <option value="Free">Free</option>
                        <option value="Paid">Paid</option>
                    </select>
                </div>
                <div>
                    <label for="filter-month" class="block text-sm font-medium text-gray-700 mb-1">Month</label>
                    <select id="filter-month" x-model="filters.month" @change="applyFilters" class="w-full p-2 border border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500">
                        <option value="">All Months</option>
                        <option value="November">November</option>
                        <option value="December">December</option>
                        <option value="Ongoing">Ongoing</option>
                    </select>
                </div>
            </div>
            
            <div x-show="filteredActivities.length === 0" class="text-center py-10 text-gray-500">
                <p class="text-xl">No activities match your current filters.</p>
                <p>Try adjusting your search criteria.</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                <template x-for="activity in pagedActivities" :key="activity.id">
                    <div @click="openModal(activity)" class="bg-white rounded-lg shadow-md hover:shadow-xl transition-shadow duration-300 cursor-pointer overflow-hidden flex flex-col">
                        <div class="p-5 flex-grow">
                            <h3 class="text-lg font-semibold text-blue-600 mb-2" x-text="activity.name"></h3>
                            <p class="text-sm text-gray-600 mb-1"><strong class="font-medium">🌍 Focus:</strong> <span x-text="activity.focus"></span></p>
                            <p class="text-sm text-gray-600 mb-3"><strong class="font-medium">📅 Dates:</strong> <span x-text="activity.datesShort"></span></p>
                            <div class="mb-2">
                                <template x-for="strand in activity.strands" :key="strand">
                                    <span :class="{
                                        'tag-creativity': strand === 'Creativity',
                                        'tag-activity': strand === 'Activity',
                                        'tag-service': strand === 'Service'
                                    }" class="tag" x-text="strand"></span>
                                </template>
                            </div>
                        </div>
                        <div class="bg-gray-50 p-3 text-right">
                            <span class="text-sm text-blue-600 font-medium">View Details &rarr;</span>
                        </div>
                    </div>
                </template>
            </div>

            <div x-show="totalPages > 1" class="mt-8 flex justify-center items-center space-x-2">
                <button @click="prevPage" :disabled="currentPage === 1" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">&laquo; Prev</button>
                <template x-for="page in pageNumbers" :key="page">
                    <button @click="goToPage(page)" :class="{'bg-blue-600 text-white': currentPage === page, 'bg-gray-200 text-gray-700 hover:bg-gray-300': currentPage !== page}" class="px-4 py-2 rounded-md" x-text="page"></button>
                </template>
                <button @click="nextPage" :disabled="currentPage === totalPages" class="px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">Next &raquo;</button>
            </div>
        </section>

        <div x-show="selectedActivity" class="modal fixed inset-0 bg-gray-800 bg-opacity-75 flex items-center justify-center p-4 z-50" :class="{'active': selectedActivity !== null}" @click.self="closeModal" x-cloak>
            <div class="bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                <div class="flex justify-between items-center p-4 border-b border-gray-200">
                    <h3 class="text-xl font-semibold text-blue-600" x-text="selectedActivity?.name"></h3>
                    <button @click="closeModal" class="text-gray-500 hover:text-gray-700">&times;</button>
                </div>
                <div class="p-6 overflow-y-auto modal-content flex-grow">
                    <p class="mb-3 text-gray-700"><strong class="font-semibold text-gray-800">Description:</strong> <span x-html="selectedActivity?.description"></span></p>
                    <p class="mb-2"><strong class="font-semibold text-gray-800">🌍 Location Focus:</strong> <span x-text="selectedActivity?.focus" class="text-gray-700"></span></p>
                    <p class="mb-2"><strong class="font-semibold text-gray-800">📅 Dates:</strong> <span x-text="selectedActivity?.dates" class="text-gray-700"></span></p>
                    <div class="mb-3">
                        <strong class="font-semibold text-gray-800">CAS Strand(s):</strong>
                        <div>
                            <template x-for="strand in selectedActivity?.strands" :key="strand">
                                <span :class="{
                                    'tag-creativity': strand === 'Creativity',
                                    'tag-activity': strand === 'Activity',
                                    'tag-service': strand === 'Service'
                                }" class="tag" x-text="strand"></span>
                            </template>
                        </div>
                    </div>
                    <p class="mb-2" x-show="selectedActivity?.potentialLOs"><strong class="font-semibold text-gray-800">Potential Learning Outcomes:</strong> <span x-text="selectedActivity?.potentialLOs" class="text-gray-700"></span></p>
                    <p class="mb-2"><strong class="font-semibold text-gray-800">🔗 URL/Contact:</strong> <span x-html="formatContact(selectedActivity?.contact)" class="text-gray-700"></span></p>
                    <p class="mb-2"><strong class="font-semibold text-gray-800">💰 Cost:</strong> <span x-text="selectedActivity?.cost" class="text-gray-700"></span></p>
                    <p class="mb-2"><strong class="font-semibold text-gray-800">⏳ Deadline:</strong> <span x-text="selectedActivity?.deadline" class="text-gray-700"></span></p>
                </div>
                <div class="p-4 border-t border-gray-200 text-right">
                    <button @click="closeModal" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Close</button>
                </div>
            </div>
        </div>
    </main>

    <footer class="bg-gray-800 text-white py-8 text-center">
        <div class="container mx-auto px-4">
            <p class="text-sm mb-2">&copy; 2025 Online CAS Explorer. Information based on public data for Nov/Dec 2025.</p>
            <p class="text-xs text-gray-400"><strong>Important Note:</strong> All activity details (dates, costs, availability) are subject to change. Please verify directly with organizers before making plans. This tool is a guide and not an official endorsement of any specific activity.</p>
        </div>
    </footer>

<script>
function casApp() {
    return {
        activeSection: 'home',
        mobileMenuOpen: false,
        activities: [],
        filteredActivities: [],
        selectedActivity: null,
        filters: {
            strand: '',
            focus: '',
            cost: '',
            month: ''
        },
        sortBy: 'name',
        itemsPerPage: 9,
        currentPage: 1,

        init() {
            this.loadActivities(); 
            this.applyFilters(); // Apply initial filters to populate the list

            this.$nextTick(() => {
                const observerOptions = { root: null, rootMargin: '0px', threshold: 0.4 };
                const observer = new IntersectionObserver((entries) => {
                    entries.forEach(entry => {
                        if (entry.isIntersecting) {
                            this.activeSection = entry.target.id;
                        }
                    });
                }, observerOptions);
                document.querySelectorAll('main section').forEach(section => observer.observe(section));
            
                window.addEventListener('hashchange', () => {
                    const hash = window.location.hash.substring(1);
                    if (hash) this.setActiveSection(hash);
                });
                
                if (window.location.hash) {
                    this.setActiveSection(window.location.hash.substring(1));
                } else {
                    this.setActiveSection('home');
                }
            });
        },

        setActiveSection(sectionId) {
            this.activeSection = sectionId;
            const element = document.getElementById(sectionId);
            if (element) {
                const headerOffset = document.querySelector('header').offsetHeight;
                const elementPosition = element.getBoundingClientRect().top;
                const offsetPosition = elementPosition + window.pageYOffset - headerOffset - 10; 
                window.scrollTo({
                     top: offsetPosition,
                     behavior: "smooth"
                });
            }
        },

        loadActivities() {
            this.activities = [
                { 
                    id: 'c1', 
                    name: 'National Novel Writing Month (NaNoWriMo)', 
                    description: 'Join the global challenge to write a novel (or a self-set word count goal via the Young Writers Program) in 30 days. This is an excellent, structured creative project requiring significant commitment.', 
                    potentialLOs: 'LO1 (strengths/growth), LO2 (new skills), LO4 (commitment)', 
                    strands: ['Creativity'], 
                    primaryStrand: 'Creativity', 
                    focus: 'Global', 
                    cost: 'Free', 
                    dates: 'November 1 - November 30, 2025', 
                    datesShort: 'November', 
                    contact: 'nanowrimo.org (Main site) / ywp.nanowrimo.org (Young Writers Program)', 
                    deadline: 'Sign-ups open, event starts Nov 1.' 
                },
                { 
                    id: 's1', 
                    name: 'Amnesty International Japan: "Write for Rights" (ライティングマラソン)', 
                    description: 'Participate in Japan\'s "Writing Marathon," part of the global Write for Rights campaign. Research cases of individuals whose human rights are at risk and write letters to authorities demanding justice and to the individuals to show solidarity.', 
                    potentialLOs: 'LO5 (collaboration), LO6 (global issues), LO7 (ethics)', 
                    strands: ['Service', 'Creativity'], 
                    primaryStrand: 'Service', 
                    focus: 'Japan Focus', 
                    cost: 'Free', 
                    dates: 'Campaign runs Nov - Dec, peaking around December 10 (Human Rights Day).', 
                    datesShort: 'Nov - Dec', 
                    contact: 'amnesty.or.jp (Search for "ライティングマラソン" or "Write for Rights" starting in November)', 
                    deadline: 'Letter-writing is ongoing during the campaign (Nov-Dec).' 
                },
                { 
                    id: 's2', 
                    name: 'Zooniverse - Citizen Science Projects', 
                    description: 'Participate in people-powered research. Classify galaxies from telescope images, transcribe historical Japanese manuscripts, or identify animals from camera traps in remote ecosystems. Dozens of projects available.', 
                    potentialLOs: 'LO1, LO4, LO6 (scientific/global issues)', 
                    strands: ['Service'], 
                    primaryStrand: 'Service', 
                    focus: 'Global', 
                    cost: 'Free', 
                    dates: 'Ongoing', 
                    datesShort: 'Ongoing', 
                    contact: 'zooniverse.org', 
                    deadline: 'N/A (Ongoing)' 
                },
                { 
                    id: 'c2', 
                    name: 'LibriVox - Public Domain Audiobook Volunteer', 
                    description: 'Volunteer to read and record chapters of public domain books to create free audiobooks. This requires creativity in voice acting and technical skill in recording/editing audio. Can also volunteer as an editor or proof-listener.', 
                    potentialLOs: 'LO2 (new skills), LO4 (commitment), LO5 (collaboration)', 
                    strands: ['Creativity', 'Service'], 
                    primaryStrand: 'Creativity', 
                    focus: 'Global', 
                    cost: 'Free', 
                    dates: 'Ongoing', 
                    datesShort: 'Ongoing', 
                    contact: 'librivox.org', 
                    deadline: 'N/A (Ongoing)' 
                },
                { 
                    id: 'a1', 
                    name: 'Stage:0 - Japan High School Esports Tournament', 
                    description: 'Form a team and participate in one of Japan\'s largest online high school esports tournaments. Requires teamwork, strategic planning (Creativity), and sustained practice (Activity). Check for winter season qualifiers.', 
                    potentialLOs: 'LO1 (strengths), LO2 (new skills), LO4, LO5 (collaboration)', 
                    strands: ['Activity', 'Creativity'], 
                    primaryStrand: 'Activity', 
                    focus: 'Japan Focus', 
                    cost: 'Free', 
                    dates: 'Registration/Qualifying rounds for winter events may occur in Nov/Dec.', 
                    datesShort: 'Nov - Dec (Check Schedule)', 
                    contact: 'stage0.jp (Check for 2025-2026 Winter season announcements)', 
                    deadline: 'Varies by game and season.' 
                },
                { 
                    id: 's3', 
                    name: 'Be My Eyes - Volunteer for the Blind', 
                    description: 'Be a pair of eyes for a blind or low-vision person through a live video call via a smartphone app. Assist with simple, real-time tasks like reading labels, checking dates, or describing surroundings.', 
                    potentialLOs: 'LO1, LO6, LO7 (ethics of interaction)', 
                    strands: ['Service'], 
                    primaryStrand: 'Service', 
                    focus: 'Global', 
                    cost: 'Free', 
                    dates: 'Ongoing (Calls are random, based on need)', 
                    datesShort: 'Ongoing', 
                    contact: 'bemyeyes.com (Requires smartphone app)', 
                    deadline: 'N/A (Ongoing)' 
                },
                { 
                    id: 'c3', 
                    name: 'AtCoder Regular/Grand Contests', 
                    description: 'Participate in world-class competitive programming contests hosted online from Japan. Solve complex algorithmic challenges within a time limit. A strong creative challenge for students with coding skills.', 
                    potentialLOs: 'LO1, LO2 (problem-solving skills), LO4', 
                    strands: ['Creativity'], 
                    primaryStrand: 'Creativity', 
                    focus: 'Japan Focus', 
                    cost: 'Free', 
                    dates: 'Regular contests on weekends (Check schedule for Nov/Dec 2025)', 
                    datesShort: 'Nov - Dec (Weekends)', 
                    contact: 'atcoder.jp', 
                    deadline: 'Register online before each contest.' 
                },
                { 
                    id: 'a2', 
                    name: '"Go Healthy!" Virtual Fitness Challenge (Japan)', 
                    description: 'Join an online virtual fitness challenge. Log your physical activity (running, walking, cycling, home workouts) to contribute to a collective goal. Requires sustained personal physical exertion.', 
                    potentialLOs: 'LO1 (physical health), LO2 (new habits), LO4 (commitment)', 
                    strands: ['Activity'], 
                    primaryStrand: 'Activity', 
                    focus: 'Japan Focus', 
                    cost: 'Free', 
                    dates: 'November 1 - December 15, 2025 (Plausible dates)', 
                    datesShort: 'Nov 1 - Dec 15', 
                    contact: 'Search for "virtual marathon Japan" or "online fitness challenge Japan" in late 2025.', 
                    deadline: 'Registration likely by early November.' 
                },
                { 
                    id: 'c4', 
                    name: 'International Digital Art Competition (Plausible)', 
                    description: 'Enter an online art competition for high school students. Create an original digital painting, 3D model, or animation based on a set theme (e.g., "Connection"). Requires developing a creative idea and executing it technically.', 
                    potentialLOs: 'LO1, LO2 (digital tools), LO3 (planning)', 
                    strands: ['Creativity'], 
                    primaryStrand: 'Creativity', 
                    focus: 'Global', 
                    cost: 'Free', 
                    dates: 'Submission Deadline: December 1, 2025 (Plausible)', 
                    datesShort: 'Deadline: Dec 1', 
                    contact: 'Search for "high school digital art contest" or "student animation festival" on platforms like ArtStation or university websites.', 
                    deadline: 'December 1, 2025' 
                },
                { 
                    id: 's4', 
                    name: 'Translators Without Borders (TWB) Kató', 
                    description: 'For highly fluent bilingual students (e.g., Japanese/English). Volunteer to translate short texts for NGOs and humanitarian organizations. (Note: May require being 18+, but students can check eligibility for specific projects).', 
                    potentialLOs: 'LO2 (translation skills), LO5, LO6 (global aid), LO7', 
                    strands: ['Service'], 
                    primaryStrand: 'Service', 
                    focus: 'Global', 
                    cost: 'Free', 
                    dates: 'Ongoing', 
                    datesShort: 'Ongoing', 
                    contact: 'translatorswithoutborders.org/kato-platform/', 
                    deadline: 'N/A (Ongoing)' 
                }
            ];
        },

        applyFilters() {
            this.currentPage = 1;
            let tempActivities = this.activities;

            if (this.filters.strand) {
                tempActivities = tempActivities.filter(act => act.strands.includes(this.filters.strand));
            }
            if (this.filters.focus) {
                tempActivities = tempActivities.filter(act => act.focus === this.filters.focus);
            }
            if (this.filters.cost) {
                tempActivities = tempActivities.filter(act => act.cost === this.filters.cost);
            }
            if (this.filters.month) {
                const month = this.filters.month;
                tempActivities = tempActivities.filter(act => {
                    if (month === 'Ongoing') {
                        // If "Ongoing" is selected, show *only* ongoing
                        return act.dates.includes('Ongoing');
                    }
                    // If "November" or "December" is selected, show items matching that month *or* Ongoing
                    return act.dates.includes(month) || act.dates.includes('Ongoing');
                });
            }
            
            this.filteredActivities = tempActivities;
            this.sortActivities(); 
        },
        
        sortActivities() {
            let sorted = [...this.filteredActivities];
            if (this.sortBy === 'name') {
                sorted.sort((a, b) => a.name.localeCompare(b.name));
            } else if (this.sortBy === 'organization') {
                sorted.sort((a, b) => {
                    const orgA = a.contact.split(' ')[0].replace('www.', '').replace('http://', '').replace('https://', '');
                    const orgB = b.contact.split(' ')[0].replace('www.', '').replace('http://', '').replace('https://', '');
                    return orgA.localeCompare(orgB);
                });
            } else if (this.sortBy === 'strand') {
                sorted.sort((a, b) => a.primaryStrand.localeCompare(b.primaryStrand));
            }
            this.filteredActivities = sorted;
        },
        
        get pagedActivities() {
            const start = (this.currentPage - 1) * this.itemsPerPage;
            const end = start + this.itemsPerPage;
            return this.filteredActivities.slice(start, end);
        },

        get totalPages() {
            return Math.ceil(this.filteredActivities.length / this.itemsPerPage);
        },
        
        get pageNumbers() {
            const numbers = [];
            const maxPagesToShow = 5;
            let startPage = Math.max(1, this.currentPage - Math.floor(maxPagesToShow / 2));
            let endPage = Math.min(this.totalPages, startPage + maxPagesToShow - 1);
            
            if (endPage - startPage + 1 < maxPagesToShow) {
                 startPage = Math.max(1, endPage - maxPagesToShow + 1);
            }

            for (let i = startPage; i <= endPage; i++) {
                numbers.push(i);
            }
            return numbers;
        },

        nextPage() {
            if (this.currentPage < this.totalPages) this.currentPage++;
        },

        prevPage() {
            if (this.currentPage > 1) this.currentPage--;
        },
        
        goToPage(pageNumber) {
            this.currentPage = pageNumber;
        },

        openModal(activity) {
            this.selectedActivity = activity;
        },

        closeModal() {
            this.selectedActivity = null;
        },

        formatContact(contactInfo) {
            if (!contactInfo) return 'N/A';
            const urlRegex = /(https?:\/\/[^\s\[]+|[a-zA-Z0-9.-]+\.[a-z]{2,})/g;
            const emailRegex = /([a-zA-Z0-9._-]+@[a-zA-Z0-9._-]+\.[a-zA-Z0-9_-]+)/g;
            
            let formatted = contactInfo.replace(urlRegex, (match) => {
                if (match.startsWith('http')) {
                    return `<a href="${match}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline break-all">${match}</a>`;
                }
                if (match.includes('@')) {
                     return `<a href="mailto:${match}" class="text-blue-600 hover:underline break-all">${match}</a>`;
                }
                return `<a href="https://${match}" target="_blank" rel="noopener noreferrer" class="text-blue-600 hover:underline break-all">${match}</a>`;
            });
            formatted = formatted.replace(emailRegex, '<a href="mailto:$1" class="text-blue-600 hover:underline break-all">$1</a>');
            return formatted;
        }
    };
}
</script>
</body>
</html>

